<!-- udacimak v1.4.4 -->
<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="ie=edge" http-equiv="X-UA-Compatible"/>
  <title>
   Summary of Data Driven and Model Based Approaches
  </title>
  <link href="../assets/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="../assets/css/plyr.css" rel="stylesheet"/>
  <link href="../assets/css/katex.min.css" rel="stylesheet"/>
  <link href="../assets/css/jquery.mCustomScrollbar.min.css" rel="stylesheet"/>
  <link href="../assets/css/styles.css" rel="stylesheet"/>
  <link href="../assets/img/udacimak.png" rel="shortcut icon" type="image/png">
  </link>
 </head>
 <body>
  <div class="wrapper">
   <nav id="sidebar">
    <div class="sidebar-header">
     <h3>
      Prediction
     </h3>
    </div>
    <ul class="sidebar-list list-unstyled CTAs">
     <li>
      <a class="article" href="../index.html">
       Back to Home
      </a>
     </li>
    </ul>
    <ul class="sidebar-list list-unstyled components">
     <li class="">
      <a href="01. Introduction and Overview.html">
       01. Introduction and Overview
      </a>
     </li>
     <li class="">
      <a href="02. IO Recap.html">
       02. I/O Recap
      </a>
     </li>
     <li class="">
      <a href="03. Model-Based vs Data-Driven Approaches.html">
       03. Model-Based vs Data-Driven Approaches
      </a>
     </li>
     <li class="">
      <a href="04. Which is Best.html">
       04. Which is Best?
      </a>
     </li>
     <li class="">
      <a href="05. Data Driven Example - Trajectory Clustering.html">
       05. Data Driven Example - Trajectory Clustering
      </a>
     </li>
     <li class="">
      <a href="06. Trajectory Clustering 2 - Online Prediction.html">
       06. Trajectory Clustering 2 - Online Prediction
      </a>
     </li>
     <li class="">
      <a href="07. Thinking about Model Based Approaches.html">
       07. Thinking about Model Based Approaches
      </a>
     </li>
     <li class="">
      <a href="08. Frenet Coordinates.html">
       08. Frenet Coordinates
      </a>
     </li>
     <li class="">
      <a href="09. Process Models.html">
       09. Process Models
      </a>
     </li>
     <li class="">
      <a href="10. More on Process Models.html">
       10. More on Process Models
      </a>
     </li>
     <li class="">
      <a href="11. Multimodal Estimation.html">
       11. Multimodal Estimation
      </a>
     </li>
     <li class="">
      <a href="12. Summary of Data Driven and Model Based Approaches.html">
       12. Summary of Data Driven and Model Based Approaches
      </a>
     </li>
     <li class="">
      <a href="13. Overview of Hybrid Approaches.html">
       13. Overview of Hybrid Approaches
      </a>
     </li>
     <li class="">
      <a href="14. Intro to Naive Bayes.html">
       14. Intro to Naive Bayes
      </a>
     </li>
     <li class="">
      <a href="15. Naive Bayes Quiz.html">
       15. Naive Bayes Quiz
      </a>
     </li>
     <li class="">
      <a href="16. Implement Naive Bayes C++.html">
       16. Implement Naive Bayes C++
      </a>
     </li>
     <li class="">
      <a href="17. Implement Naive Bayes C++ (solution).html">
       17. Implement Naive Bayes C++ (solution)
      </a>
     </li>
     <li class="">
      <a href="18. Conclusion.html">
       18. Conclusion
      </a>
     </li>
    </ul>
    <ul class="sidebar-list list-unstyled CTAs">
     <li>
      <a class="article" href="../index.html">
       Back to Home
      </a>
     </li>
    </ul>
   </nav>
   <div id="content">
    <header class="container-fluild header">
     <div class="container">
      <div class="row">
       <div class="col-12">
        <div class="align-items-middle">
         <button class="btn btn-toggle-sidebar" id="sidebarCollapse" type="button">
          <div>
          </div>
          <div>
          </div>
          <div>
          </div>
         </button>
         <h1 style="display: inline-block">
          12. Summary of Data Driven and Model Based Approaches
         </h1>
        </div>
       </div>
      </div>
     </div>
    </header>
    <main class="container">
     <div class="row">
      <div class="col-12">
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <h1 id="summary-so-far">
          Summary so Far
         </h1>
         <p>
          So far you have learned about the two main approaches to prediction.
         </p>
         <h2 id="1-data-driven-approaches">
          1. Data-Driven Approaches
         </h2>
         <p>
          Data-driven approaches solve the prediction problem in two phases:
         </p>
         <ol>
          <li>
           Offline training
          </li>
          <li>
           Online Prediction
          </li>
         </ol>
         <h3 id="11-offline-training">
          1.1 Offline Training
         </h3>
         <p>
          In this phase the goal is to feed some machine learning algorithm a lot of data to train it. For the trajectory clustering example this involved:
         </p>
         <ol>
          <li>
           <strong>
            Define similarity
           </strong>
           - we first need a definition of similarity that agrees with human common-sense definition.
          </li>
          <li>
           <strong>
            Unsupervised clustering
           </strong>
           - at this step some machine learning algorithm clusters the trajectories we've observed.
          </li>
          <li>
           <strong>
            Define Prototype Trajectories
           </strong>
           - for each cluster identify some small number of typical "prototype" trajectories.
          </li>
         </ol>
         <h3 id="12-online-prediction">
          1.2 Online Prediction
         </h3>
         <p>
          Once the algorithm is trained we bring it onto the road. When we encounter a situation for which the trained algorithm is appropriate (returning to an intersection for example) we can use that algorithm to actually predict the trajectory of the vehicle. For the intersection example this meant:
         </p>
         <ol>
          <li>
           <strong>
            Observe Partial Trajectory
           </strong>
           - As the target vehicle drives we can think of it leaving a "partial trajectory" behind it.
          </li>
          <li>
           <strong>
            Compare to Prototype Trajectories
           </strong>
           - We can compare this partial trajectory to the
           <em>
            corresponding parts
           </em>
           of the prototype trajectories. When these partial trajectories are more similar (using the same notion of similarity defined earlier) their likelihoods should increase relative to the other trajectories.
          </li>
          <li>
           <strong>
            Generate Predictions
           </strong>
           - For each cluster we identify the most likely prototype trajectory. We broadcast each of these trajectories along with the associated probability (see the image below).
          </li>
         </ol>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <figure class="figure">
          <img alt="" class="img img-fluid" src="img/prediction-1.jpg"/>
          <figcaption class="figure-caption">
          </figcaption>
         </figure>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <h2 id="2-model-based-approaches">
          2. Model Based Approaches
         </h2>
         <p>
          You can think of model based solutions to the prediction problem as also having an "offline" and online component. In that view, this approach requires:
         </p>
         <ol>
          <li>
           <em>
            Defining
           </em>
           process models (offline).
          </li>
          <li>
           <em>
            Using
           </em>
           process models to compare driver behavior to what would be expected for each model.
          </li>
          <li>
           <em>
            Probabilistically classifying
           </em>
           driver intent by comparing the likelihoods of various behaviors with a multiple-model algorithm.
          </li>
          <li>
           <em>
            Extrapolating
           </em>
           process models to generate trajectories.
          </li>
         </ol>
         <h3 id="21-defining-process-models">
          2.1 Defining Process Models
         </h3>
         <p>
          You saw how process models can vary in complexity from very simple…
         </p>
         <div class="mathquill">
          \large
\begin{bmatrix}
\dot{s}\\ 
\dot{d}
\end{bmatrix} = 
\begin{bmatrix}
s_{0} \\
0
 \end{bmatrix} + 
\mathbf{w}
         </div>
         <p>
          to very complex…
         </p>
         <div class="mathquill">
          \large
\begin{bmatrix}
\ddot{s} \\
\ddot{d} \\
\ddot{\theta}
 \end{bmatrix} = 
\begin{bmatrix}
\dot{\theta}\dot{d} + a_s \\
-\dot{\theta}\dot{s} + \frac{2}{m}(F_{c,f}\cos\delta + F_{c,r}) \\
\frac{2}{I_z} (l_f F_{c,f} - l_rF_{c,r})
 \end{bmatrix} +
\mathbf{w}
         </div>
         <h3 id="22-using-process-models">
          2.2 Using Process Models
         </h3>
         <p>
          Process Models are first used to compare a target vehicle's observed behavior to the behavior we would expect for each of the maneuvers we've created models for. The pictures below help explain how process models are used to calculate these likelihoods.
         </p>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <figure class="figure">
          <img alt="" class="img img-fluid" src="img/prediction-2.jpg"/>
          <figcaption class="figure-caption">
          </figcaption>
         </figure>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <p>
          On the left we see two images of a car. At time
          <span class="mathquill ud-math">
           k-1
          </span>
          we predicted where the car would be if it were to go straight vs go right. Then at time
          <span class="mathquill ud-math">
           k
          </span>
          we look at where the car actually is. The graph on the right shows the car's observed
          <span class="mathquill ud-math">
           s
          </span>
          coordinate along with the probability distributions for where we
          <em>
           expected
          </em>
          the car to be at that time.  In this case, the
          <span class="mathquill ud-math">
           s
          </span>
          that we observe is substantially more consistent with turning right than going straight.
         </p>
         <h3 id="23-classifying-intent-with-multiple-model-algorithm">
          2.3 Classifying Intent with Multiple Model Algorithm
         </h3>
         <p>
          In the image at the top of the page you can see a bar chart representing probabilities of various
          <em>
           clusters
          </em>
          over time. Multiple model algorithms serve a similar purpose for model based approaches: they are responsible for maintaining beliefs for the probability of each maneuver. The algorithm we discussed is called the
          <strong>
           Autonomous Multiple Model
          </strong>
          algorithm (AMM). AMM can be summarized with this equation:
         </p>
         <div class="mathquill">
          \large
\mu_k^{(i)} = \frac{\mu_{k-1}^{(i)}L_k^{(i)}}{\sum_{j=1}^M\mu_{k-1}^{(j)}L_k^{(j)}}
         </div>
         <p>
          or, if we ignore the denominator (since it just serves to normalize the probabilities), we can capture the essence of this algorithm with
         </p>
         <div class="mathquill">
          \mu_k^{(i)} \propto \mu_{k-1}^{(i)}L_k^{(i)}
         </div>
         <p>
          where the
          <span class="mathquill ud-math">
           \mu_k^{(i)}
          </span>
          is the probability that model number
          <span class="mathquill ud-math">
           i
          </span>
          is the correct model at time
          <span class="mathquill ud-math">
           k
          </span>
          and
          <span class="mathquill ud-math">
           L_k^{(i)}
          </span>
          is the
          <strong>
           likelihood
          </strong>
          for that model (as computed by comparison to process model).
         </p>
         <p>
          The paper,
          <a href="https://d17h27t6h515a5.cloudfront.net/topher/2017/June/5953fc34_a-comparative-study-of-multiple-model-algorithms-for-maneuvering-target-tracking/a-comparative-study-of-multiple-model-algorithms-for-maneuvering-target-tracking.pdf" rel="noopener noreferrer" target="_blank">
           "A comparative study of multiple model algorithms for maneuvering target tracking"
          </a>
          is a good reference to learn more.
         </p>
         <h3 id="24-trajectory-generation">
          2.4 Trajectory Generation
         </h3>
         <p>
          Trajectory generation is straightforward once we have a process model. We simply iterate our model over and over until we've generated a prediction that spans whatever time horizon we are supposed to cover. Note that each iteration of the process model will necessarily add uncertainty to our prediction.
         </p>
        </div>
       </div>
       <div class="divider">
       </div>
      </div>
      <div class="col-12">
       <p class="text-right">
        <a class="btn btn-outline-primary mt-4" href="13. Overview of Hybrid Approaches.html" role="button">
         Next Concept
        </a>
       </p>
      </div>
     </div>
    </main>
    <footer class="footer">
     <div class="container">
      <div class="row">
       <div class="col-12">
        <p class="text-center">
         udacity2.0 If you need the newest courses Plase add me wechat: udacity6
        </p>
       </div>
      </div>
     </div>
    </footer>
   </div>
  </div>
  <script src="../assets/js/jquery-3.3.1.min.js">
  </script>
  <script src="../assets/js/plyr.polyfilled.min.js">
  </script>
  <script src="../assets/js/bootstrap.min.js">
  </script>
  <script src="../assets/js/jquery.mCustomScrollbar.concat.min.js">
  </script>
  <script src="../assets/js/katex.min.js">
  </script>
  <script>
   // Initialize Plyr video players
    const players = Array.from(document.querySelectorAll('video')).map(p => new Plyr(p));

    // render math equations
    let elMath = document.getElementsByClassName('mathquill');
    for (let i = 0, len = elMath.length; i < len; i += 1) {
      const el = elMath[i];

      katex.render(el.textContent, el, {
        throwOnError: false
      });
    }

    // this hack will make sure Bootstrap tabs work when using Handlebars
    if ($('#question-tabs').length && $('#user-answer-tabs').length) {
      $("#question-tabs a.nav-link").on('click', function () {
        $("#question-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
      $("#user-answer-tabs a.nav-link").on('click', function () {
        $("#user-answer-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
    } else {
      $("a.nav-link").on('click', function () {
        $(".tab-pane").hide();
        $($(this).attr("href")).show();
      });
    }

    // side bar events
    $(document).ready(function () {
      $("#sidebar").mCustomScrollbar({
        theme: "minimal"
      });

      $('#sidebarCollapse').on('click', function () {
        $('#sidebar, #content').toggleClass('active');
        $('.collapse.in').toggleClass('in');
        $('a[aria-expanded=true]').attr('aria-expanded', 'false');
      });

      // scroll to first video on page loading
      if ($('video').length) {
        $('html,body').animate({ scrollTop: $('div.plyr').prev().offset().top});
      }

      // auto play first video: this may not work with chrome/safari due to autoplay policy
      if (players && players.length > 0) {
        players[0].play();
      }

      // scroll sidebar to current concept
      const currentInSideBar = $( "ul.sidebar-list.components li a:contains('12. Summary of Data Driven and Model Based Approaches')" )
      currentInSideBar.css( "text-decoration", "underline" );
      $("#sidebar").mCustomScrollbar('scrollTo', currentInSideBar);
    });
  </script>
 </body>
</html>
