<!-- udacimak v1.4.4 -->
<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="ie=edge" http-equiv="X-UA-Compatible"/>
  <title>
   Parameter Tuning
  </title>
  <link href="../assets/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="../assets/css/plyr.css" rel="stylesheet"/>
  <link href="../assets/css/katex.min.css" rel="stylesheet"/>
  <link href="../assets/css/jquery.mCustomScrollbar.min.css" rel="stylesheet"/>
  <link href="../assets/css/styles.css" rel="stylesheet"/>
  <link href="../assets/img/udacimak.png" rel="shortcut icon" type="image/png">
  </link>
 </head>
 <body>
  <div class="wrapper">
   <nav id="sidebar">
    <div class="sidebar-header">
     <h3>
      Object Detection
     </h3>
    </div>
    <ul class="sidebar-list list-unstyled CTAs">
     <li>
      <a class="article" href="../index.html">
       Back to Home
      </a>
     </li>
    </ul>
    <ul class="sidebar-list list-unstyled components">
     <li class="">
      <a href="01. Intro to Vehicle Tracking.html">
       01. Intro to Vehicle Tracking
      </a>
     </li>
     <li class="">
      <a href="02. Arpan and Drew.html">
       02. Arpan and Drew
      </a>
     </li>
     <li class="">
      <a href="03. Finding Cars.html">
       03. Finding Cars
      </a>
     </li>
     <li class="">
      <a href="04. Object Detection Overview.html">
       04. Object Detection Overview
      </a>
     </li>
     <li class="">
      <a href="05. Manual Vehicle Detection.html">
       05. Manual Vehicle Detection
      </a>
     </li>
     <li class="">
      <a href="06. Features.html">
       06. Features
      </a>
     </li>
     <li class="">
      <a href="07. Feature Intuition.html">
       07. Feature Intuition
      </a>
     </li>
     <li class="">
      <a href="08. Color Features.html">
       08. Color Features
      </a>
     </li>
     <li class="">
      <a href="09. Template Matching.html">
       09. Template Matching
      </a>
     </li>
     <li class="">
      <a href="10. Template Matching Quiz.html">
       10. Template Matching Quiz
      </a>
     </li>
     <li class="">
      <a href="11. Color Histogram Features.html">
       11. Color Histogram Features
      </a>
     </li>
     <li class="">
      <a href="12. Histograms of Color.html">
       12. Histograms of Color
      </a>
     </li>
     <li class="">
      <a href="13. Histogram Comparison.html">
       13. Histogram Comparison
      </a>
     </li>
     <li class="">
      <a href="14. Color Spaces.html">
       14. Color Spaces
      </a>
     </li>
     <li class="">
      <a href="15. Explore Color Spaces.html">
       15. Explore Color Spaces
      </a>
     </li>
     <li class="">
      <a href="16. Spatial Binning of Color.html">
       16. Spatial Binning of Color
      </a>
     </li>
     <li class="">
      <a href="17. Gradient Features.html">
       17. Gradient Features
      </a>
     </li>
     <li class="">
      <a href="18. HOG Features.html">
       18. HOG Features
      </a>
     </li>
     <li class="">
      <a href="19. Data Exploration.html">
       19. Data Exploration
      </a>
     </li>
     <li class="">
      <a href="20. scikit-image HOG.html">
       20. scikit-image HOG
      </a>
     </li>
     <li class="">
      <a href="21. Combining Features.html">
       21. Combining Features
      </a>
     </li>
     <li class="">
      <a href="22. Combine and Normalize Features.html">
       22. Combine and Normalize Features
      </a>
     </li>
     <li class="">
      <a href="23. Build a Classifier.html">
       23. Build a Classifier
      </a>
     </li>
     <li class="">
      <a href="24. Labeled Data.html">
       24. Labeled Data
      </a>
     </li>
     <li class="">
      <a href="25. Data Preparation.html">
       25. Data Preparation
      </a>
     </li>
     <li class="">
      <a href="26. Train a Classifier.html">
       26. Train a Classifier
      </a>
     </li>
     <li class="">
      <a href="27. Parameter Tuning.html">
       27. Parameter Tuning
      </a>
     </li>
     <li class="">
      <a href="28. Color Classify.html">
       28. Color Classify
      </a>
     </li>
     <li class="">
      <a href="29. HOG Classify.html">
       29. HOG Classify
      </a>
     </li>
     <li class="">
      <a href="30. Sliding Windows.html">
       30. Sliding Windows
      </a>
     </li>
     <li class="">
      <a href="31. How many windows.html">
       31. How many windows?
      </a>
     </li>
     <li class="">
      <a href="32. Sliding Window Implementation.html">
       32. Sliding Window Implementation
      </a>
     </li>
     <li class="">
      <a href="33. Multi-scale Windows.html">
       33. Multi-scale Windows
      </a>
     </li>
     <li class="">
      <a href="34. Search and Classify.html">
       34. Search and Classify
      </a>
     </li>
     <li class="">
      <a href="35. Hog Sub-sampling Window Search.html">
       35. Hog Sub-sampling Window Search
      </a>
     </li>
     <li class="">
      <a href="36. False Positives.html">
       36. False Positives
      </a>
     </li>
     <li class="">
      <a href="37. Multiple Detections &amp; False Positives.html">
       37. Multiple Detections &amp; False Positives
      </a>
     </li>
     <li class="">
      <a href="38. Tracking Pipeline.html">
       38. Tracking Pipeline
      </a>
     </li>
     <li class="">
      <a href="39. Summary.html">
       39. Summary
      </a>
     </li>
     <li class="">
      <a href="40. Traditional vs. Deep Learning Approach.html">
       40. Traditional vs. Deep Learning Approach
      </a>
     </li>
    </ul>
    <ul class="sidebar-list list-unstyled CTAs">
     <li>
      <a class="article" href="../index.html">
       Back to Home
      </a>
     </li>
    </ul>
   </nav>
   <div id="content">
    <header class="container-fluild header">
     <div class="container">
      <div class="row">
       <div class="col-12">
        <div class="align-items-middle">
         <button class="btn btn-toggle-sidebar" id="sidebarCollapse" type="button">
          <div>
          </div>
          <div>
          </div>
          <div>
          </div>
         </button>
         <h1 style="display: inline-block">
          27. Parameter Tuning
         </h1>
        </div>
       </div>
      </div>
     </div>
    </header>
    <main class="container">
     <div class="row">
      <div class="col-12">
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <h2 id="parameter-tuning">
          Parameter Tuning
         </h2>
         <h3 id="svm-hyperparameters">
          SVM Hyperparameters
         </h3>
         <p>
          In the SVM lesson, Katie mentioned optimizing the Gamma and C parameters.
         </p>
         <p>
          Successfully tuning your algorithm involves searching for a kernel, a gamma value and a C value that minimize prediction error. To tune your SVM vehicle detection model, you can use one of scikit-learn's parameter tuning algorithms.
         </p>
         <p>
          When tuning SVM, remember that you can only tune the C parameter with a linear kernel. For a non-linear kernel, you can tune C and gamma.
         </p>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <h3 id="parameter-tuning-in-scikit-learn">
          Parameter Tuning in Scikit-learn
         </h3>
         <p>
          Scikit-learn includes two algorithms for carrying out an automatic parameter search:
         </p>
         <ul>
          <li>
           <a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html#sklearn.model_selection.GridSearchCV" rel="noopener noreferrer" target="_blank">
            GridSearchCV
           </a>
          </li>
          <li>
           <a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.RandomizedSearchCV.html#sklearn.model_selection.RandomizedSearchCV" rel="noopener noreferrer" target="_blank">
            RandomizedSearchCV
           </a>
          </li>
         </ul>
         <p>
          GridSearchCV exhaustively works through multiple parameter combinations, cross-validating as it goes. The beauty is that it can work through many combinations in only a couple extra lines of code.
         </p>
         <p>
          For example, if I input the values C:[0.1, 1, 10] and gamma:[0.1, 1, 10], gridSearchCV will train and cross-validate every possible combination of (C, gamma): (0.1, 0.1), (0.1, 1), (0.1, 10), (1, .1), (1, 1), etc.
         </p>
         <p>
          RandomizedSearchCV works similarly to GridSearchCV except RandomizedSearchCV takes a random sample of parameter combinations. RandomizedSearchCV is faster than GridSearchCV since RandomizedSearchCV uses a subset of the parameter combinations.
         </p>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <h3 id="cross-validation-with-gridsearchcv">
          Cross-validation with GridSearchCV
         </h3>
         <p>
          GridSearchCV uses 3-fold cross validation to determine the best performing parameter set. GridSearchCV will take in a training set and divide the training set into three equal partitions. The algorithm will train on two partitions and then validate using the third partition. Then GridSearchCV chooses a different partition for validation and trains with the other two partitions. Finally, GridSearchCV uses the last remaining partition for cross-validation and trains with the other two partitions.
         </p>
         <p>
          By default, GridSearchCV uses accuracy as an error metric by averaging the accuracy for each partition. So for every possible parameter combination, GridSearchCV calculates an accuracy score. Then GridSearchCV will choose the parameter combination that performed the best.
         </p>
        </div>
       </div>
       <div class="divider">
       </div>
       <div class="ud-atom">
        <h3>
        </h3>
        <div>
         <h3 id="scikit-learn-cross-validation-example">
          Scikit-learn Cross Validation Example
         </h3>
         <p>
          Here's an example from the sklearn
          <a href="http://scikit-learn.org/stable/modules/generated/sklearn.grid_search.GridSearchCV.html" rel="noopener noreferrer" target="_blank">
           documentation
          </a>
          for implementing GridSearchCV:
         </p>
         <p>
          <code>
           parameters = {'kernel':('linear', 'rbf'), 'C':[1, 10]}
          </code>
          <br/>
          <br>
           <code>
            svr = svm.SVC()
           </code>
           <br/>
           <br>
            <code>
             clf = grid_search.GridSearchCV(svr, parameters)
            </code>
            <br/>
            <br>
             <code>
              clf.fit(iris.data, iris.target)
             </code>
            </br>
           </br>
          </br>
         </p>
         <p>
          Let's break this down line by line.
          <br/>
          <br/>
          <br>
           <code>
            parameters = {'kernel':('linear', 'rbf'), 'C':[1, 10]}
           </code>
           <br/>
           A dictionary of the parameters, and the possible values they may take.  In this case, they're playing around with the kernel (possible choices are 'linear' and 'rbf'), and C (possible choices are 1 and 10).
          </br>
         </p>
         <p>
          Then a 'grid' of all the following combinations of values for (kernel, C) are automatically generated:
         </p>
         <p>
          | ('rbf', 1) | ('rbf', 10)|
          <br>
           |-
           <br>
            | ('linear', 1) | ('linear', 10) |
           </br>
          </br>
         </p>
         <p>
          Each is used to train an SVM, and the performance is then assessed using cross-validation.
         </p>
         <p>
          <code>
           svr = svm.SVC()
          </code>
          <br/>
          <br>
           This looks kind of like creating a classifier, just like we've been doing since the first lesson.  But note that the "clf" isn't made until the next line--this is just saying what kind of algorithm to use.  Another way to think about this is that the "classifier" isn't just the algorithm in this case, it's algorithm plus parameter values.  Note that there's no monkeying around with the kernel or C; all that is handled in the next line.
          </br>
         </p>
         <p>
          <code>
           clf = grid_search.GridSearchCV(svr, parameters)
          </code>
          <br/>
          <br>
           This is where the first bit of magic happens; the classifier is being created.  We pass the algorithm (
           <i>
            svr
           </i>
           ) and the dictionary of parameters to try (
           <i>
            parameters
           </i>
           ) and it generates a grid of parameter combinations to try.
           <br/>
          </br>
         </p>
         <p>
          <code>
           clf.fit(iris.data, iris.target)
          </code>
          <br/>
          And the second bit of magic.  The fit function now tries all the parameter combinations, and returns a fitted classifier that's automatically tuned to the optimal parameter combination.  You can now access the parameter values via
          <code>
           clf.best_params_
          </code>
          .
         </p>
        </div>
       </div>
       <div class="divider">
       </div>
      </div>
      <div class="col-12">
       <p class="text-right">
        <a class="btn btn-outline-primary mt-4" href="28. Color Classify.html" role="button">
         Next Concept
        </a>
       </p>
      </div>
     </div>
    </main>
    <footer class="footer">
     <div class="container">
      <div class="row">
       <div class="col-12">
        <p class="text-center">
         udacity2.0 If you need the newest courses Plase add me wechat: udacity6
        </p>
       </div>
      </div>
     </div>
    </footer>
   </div>
  </div>
  <script src="../assets/js/jquery-3.3.1.min.js">
  </script>
  <script src="../assets/js/plyr.polyfilled.min.js">
  </script>
  <script src="../assets/js/bootstrap.min.js">
  </script>
  <script src="../assets/js/jquery.mCustomScrollbar.concat.min.js">
  </script>
  <script src="../assets/js/katex.min.js">
  </script>
  <script>
   // Initialize Plyr video players
    const players = Array.from(document.querySelectorAll('video')).map(p => new Plyr(p));

    // render math equations
    let elMath = document.getElementsByClassName('mathquill');
    for (let i = 0, len = elMath.length; i < len; i += 1) {
      const el = elMath[i];

      katex.render(el.textContent, el, {
        throwOnError: false
      });
    }

    // this hack will make sure Bootstrap tabs work when using Handlebars
    if ($('#question-tabs').length && $('#user-answer-tabs').length) {
      $("#question-tabs a.nav-link").on('click', function () {
        $("#question-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
      $("#user-answer-tabs a.nav-link").on('click', function () {
        $("#user-answer-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
    } else {
      $("a.nav-link").on('click', function () {
        $(".tab-pane").hide();
        $($(this).attr("href")).show();
      });
    }

    // side bar events
    $(document).ready(function () {
      $("#sidebar").mCustomScrollbar({
        theme: "minimal"
      });

      $('#sidebarCollapse').on('click', function () {
        $('#sidebar, #content').toggleClass('active');
        $('.collapse.in').toggleClass('in');
        $('a[aria-expanded=true]').attr('aria-expanded', 'false');
      });

      // scroll to first video on page loading
      if ($('video').length) {
        $('html,body').animate({ scrollTop: $('div.plyr').prev().offset().top});
      }

      // auto play first video: this may not work with chrome/safari due to autoplay policy
      if (players && players.length > 0) {
        players[0].play();
      }

      // scroll sidebar to current concept
      const currentInSideBar = $( "ul.sidebar-list.components li a:contains('27. Parameter Tuning')" )
      currentInSideBar.css( "text-decoration", "underline" );
      $("#sidebar").mCustomScrollbar('scrollTo', currentInSideBar);
    });
  </script>
 </body>
</html>
